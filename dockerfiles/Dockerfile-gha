FROM node:22-alpine3.19

EXPOSE 3000

WORKDIR /app

COPY ../app/ /app/

RUN rm -rf ./node_modules && \
    rm -rf ./package-lock.json && \
    rm -rf ./.nuxt

RUN npm install -g npm@latest pm2

# # Install the dependencies
RUN npm install

RUN npm run postinstall

RUN npm run build

# CMD ["pm2-runtime", "start", "ecosystem.config.cjs"]